@import "tailwindcss";

@theme {
  --color-bp-lighter: #344b6a;
  --color-bp-dark: #0e305b;
  --color-bp-darker: #081c35;
  --color-bp-light: #dbe4ee;
  --color-bp-danger: #fe8e86;
  --color-bp-danger-darker: #bd4c44;
  --color-bp-warning: #ffc857;
  --color-bp-success: #a8f0ae;

  --font-rcgl-full: "R&C Guidelines Full", "Poppins", sans-serif;
  --font-rcgl-dark: "R&C Guidelines Dark", "Poppins", sans-serif;
  --font-rcgl-light: "R&C Guidelines", "Poppins", sans-serif;
  --font-rcgl-empty: "R&C Guidelines Empty", "Poppins", sans-serif;

  --font-rc-full: "R&C Basic Full", "Poppins", sans-serif;
  --font-rc-dark: "R&C Basic Dark", "Poppins", sans-serif;
  --font-rc-light: "R&C Basic", "Poppins", sans-serif;
  --font-rc-empty: "R&C Basic Empty", "Poppins", sans-serif;
}

:root {
  @apply bg-bp-dark text-white font-rc-full overscroll-none;
}

.grid-bg {
  background-image: linear-gradient(
      rgba(255, 255, 255, 0.05) 1px,
      transparent 1px
    ),
    linear-gradient(90deg, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
  background-size: 50px 50px;
  background-position: 0 0, 0 0;
  /* background-attachment: fixed; */
  position: relative;
}

/* Grain overlay atop grid */
.grainy-bg::after {
  content: "";
  position: fixed;
  inset: 0;
  background: radial-gradient(ellipse, #000000b1, transparent);
  opacity: 0.2;
  filter: url(#grainy);
  mix-blend-mode: multiply;
  pointer-events: none;
}

.carousel {
  animation: carousel 720s linear infinite;
}

@keyframes carousel {
  0% {
    transform: translateX(0%);
  }
  50% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(0%);
  }
}

@layer components {
  .bg-hatch {
    background-image: url("hatch.svg");
  }

  .btn {
    @apply inline-flex items-center justify-center gap-2 text-xl py-2 px-6 motion-safe:transition-colors disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer;
  }

  .btn-primary {
    @apply border-2 border-white bg-white text-gray-900 hover:bg-bp-light hover:border-bp-light disabled:hover:bg-white disabled:hover:border-white;
  }

  .btn-outline {
    @apply border-2 border-white text-white hover:bg-white/10 disabled:hover:bg-transparent;
  }

  .btn-inset {
    @apply bg-bp-dark inset-shadow-sm inset-shadow-black/25 hover:bg-bp-lighter;
  }

  .btn-nav {
    @apply bg-bp-dark !py-[8px] inset-shadow-sm inset-shadow-black/25 hover:bg-bp-lighter;
  }

  .btn-nav-active {
    @apply border-2 border-white bg-bp-dark hover:bg-bp-lighter;
  }

  .btn-nav-active.nav-submenu-container {
    @apply hover:bg-bp-dark pt-0! px-0! gap-0!;
  }

  .btn-nav-active > .nav-submenu-btn {
    @apply w-full py-1.5! hover:bg-bp-lighter motion-safe:transition-colors;
  }
  .input {
    @apply text-left text-xl py-2 px-4 appearance-none outline-0 border-2;
  }

  .select {
    @apply relative appearance-none gap-2 text-xl border-2 outline-0;
  }

  .select::before,
  .select::after {
    @apply absolute right-4 pointer-events-none;
    content: "";
  }

  .select::before {
    @apply border-l-[4.8] border-r-[4.8] border-b-[4.8] border-l-transparent border-r-transparent border-b-white top-[40%];
  }

  .select::after {
    @apply border-l-[4.8] border-r-[4.8] border-t-[4.8] border-l-transparent border-r-transparent border-t-white top-[55%];
  }

  .select select {
    @apply appearance-none outline-0 w-full py-2 px-6 pr-12;
  }

  .pagy.nav {
    @apply space-x-2;
  }

  .pagy.nav .current {
    @apply underline;
  }
}

/* Remove rendered rich text (ActionText) styles */

/* Markdown-rendered content */
.markdown {
  /* Base */
  @apply text-white leading-relaxed font-rc-full print:text-black print:bg-white print:leading-normal print:text-sm wrap-break-word;

  /* Trim outer whitespace */
  > *:first-child {
    @apply mt-0;
  }
  > *:last-child {
    @apply mb-0;
  }

  /* Headings */
  h1 {
    @apply mt-8 mb-4 pb-2 text-5xl leading-tight tracking-tight border-b border-white/20 print:mt-4 print:mb-2 print:pb-1 print:border-black/20;
  }
  h2 {
    @apply mt-8 mb-3 pb-2 text-4xl leading-tight tracking-tight border-b border-white/20 print:mt-3 print:mb-1 print:pb-1 print:border-black/20;
  }

  h3 {
    @apply mt-6 mb-2 text-3xl;
  }

  /*Same as H2 but as a green accent color*/
  h4 {
    @apply text-bp-success mt-8 mb-3 pb-2 text-3xl leading-tight tracking-tight border-b border-white/20 print:mt-3 print:mb-1 print:pb-1 print:border-black/20;
  }

  /*Same as h1 but it has the fancy blueprint lines*/
  h5 {
    @apply font-rcgl-full mt-8 mb-4 pb-2 text-5xl leading-tight tracking-tight border-b border-white/20 print:mt-4 print:mb-2 print:pb-1 print:border-black/20;
  }
  h6 {
    @apply mt-3 mb-2 text-lg;
  }

  /* Paragraphs */
  p {
    @apply my-3 print:my-2;
  }

  /* Emphasis */
  em,
  i {
    font-style: italic !important;
  }

  /* Links */
  a {
    @apply underline decoration-white/30 underline-offset-2 text-bp-warning hover:decoration-white print:no-underline print:text-black;
  }

  /* Lists */
  ul {
    @apply my-3 list-disc list-inside print:my-2;
  }
  ol {
    @apply my-3 list-decimal list-inside print:my-2;
  }
  li {
    @apply my-1 print:my-0;
  }
  li p {
    @apply my-1 print:my-0;
  }
  li > ul,
  li > ol {
    @apply mt-1 ml-4;
  }

  /* Code */
  code {
    @apply inline rounded bg-bp-darker px-1 py-0 text-sm font-mono print:bg-white print:text-black;
  }
  pre {
    @apply my-4 overflow-x-auto rounded-lg bg-bp-darker p-2 print:bg-white print:border-black/20;
  }
  pre code {
    @apply bg-transparent p-0 text-inherit inline;
  }

  /* Blockquote */
  blockquote {
    @apply my-4 border-l-4 border-white/30 pl-4 italic text-white/80 print:border-black/20 print:text-black;
  }

  /* Horizontal rule */
  hr {
    @apply my-6 border-t border-white/20 print:border-black/20;
  }

  /* Images */
  img {
    @apply w-auto h-auto max-w-[min(100%,64rem)] max-h-[80vh] my-4 block mx-auto;
  }

  @media print {
    img {
      max-width: 100%;
      max-height: none;
    }
  }

  .external-image-callout {
    @apply w-full text-center bg-bp-darker py-2;
  }

  /* Tables */
  table {
    @apply w-full table-auto text-left border-collapse my-6;
  }
  thead th {
    @apply border-b border-white/30 py-2 px-3 print:border-black/40;
  }
  tbody td {
    @apply border-b border-white/10 py-2 px-3 align-top print:border-black/20;
  }
  tbody tr:last-child td {
    @apply border-b-0;
  }

  pre {
    display: block;
  }

  aside {
    @apply my-6 p-4 bg-bp-darker border-l-4 border-bp-light rounded-r-lg;
  }

  code {
    .nocode {
      background-color: none;
      color: #ffffff;
    }
    .str {
      color: #ffa0a0;
    }
    .kwd {
      color: #f0e68c;
    }
    .com {
      color: #87ceeb;
    }
    .typ {
      color: #98fb98;
    }
    .lit {
      color: #cd5c5c;
    }
    .pun {
      color: #fff;
    }
    .pln {
      color: #fff;
    }
    .tag {
      color: #f0e68c;
    }
    .atn {
      color: #bdb76b;
    }
    .atv {
      color: #ffa0a0;
    }
    .dec {
      color: #98fb98;
    }

    /* Specify class=linenums on a pre to get line numbering */
    ol.linenums {
      margin-top: 0;
      margin-bottom: 0;
      color: #aeaeae;
    }
    li.L0,
    li.L1,
    li.L2,
    li.L3,
    li.L5,
    li.L6,
    li.L7,
    li.L8 {
      list-style-type: none;
    }

    @media print {
      background-color: none;
      .str,
      code .str {
        color: #060;
      }
      .kwd,
      code .kwd {
        color: #006;
      }
      .com,
      code .com {
        color: #600;
        font-style: italic;
      }
      .typ,
      code .typ {
        color: #404;
      }
      .lit,
      code .lit {
        color: #044;
      }
      .pun,
      code .pun {
        color: #440;
      }
      .pln,
      code .pln {
        color: #000;
      }
      .tag,
      code .tag {
        color: #006;
      }
      .atn,
      code .atn {
        color: #404;
      }
      .atv,
      code .atv {
        color: #060;
      }
    }
  }
}

.markdown.timeline-journal {
  .external-image-callout {
    @apply bg-bp-dark!;
  }

  pre,
  code {
    @apply bg-bp-dark!;
  }
}

/* Marksmith editor overrides to match app theme */
@layer components {
  /* Increase specificity and force overrides against gem utilities */
  .marksmith.marksmith-editor-wrapper {
    background-color: var(--color-bp-dark) !important;
    color: #fff !important;
    border: 2px solid #fff !important;
    border-radius: 0 !important; /* square */
    outline-width: 0 !important; /* remove focus ring */
  }
  .marksmith .marksmith-toolbar {
    background-color: var(--color-bp-dark) !important;
    color: #fff !important;
    border-bottom: 2px solid #fff !important;
    border-top-left-radius: 0 !important;
    border-top-right-radius: 0 !important;
  }
  .marksmith .marksmith-editor-content {
    background-color: var(--color-bp-darker) !important;
    width: 100% !important;
  }
  .marksmith .marksmith-textarea {
    background-color: var(--color-bp-darker) !important;
    color: #fff !important;
  }
  .marksmith .marksmith-textarea::placeholder {
    color: rgba(255, 255, 255, 0.4) !important;
  }
  .marksmith .marksmith-preview-pane {
    background-color: var(--color-bp-dark) !important;
    color: #fff;
    width: 100% !important;
    height: 22.37rem !important; /* kind of cooked but it works */
    overflow-y: auto;
    padding: 1rem !important;
  }
  .marksmith .marksmith-loading-indicator .double-bounce1,
  .marksmith .marksmith-loading-indicator .double-bounce2 {
    background-color: #fff !important;
  }
  .marksmith .marksmith-bottom-toolbar {
    background-color: var(--color-bp-dark) !important;
    color: #fff !important;
    border-top: 2px solid #fff !important;
    border-bottom-left-radius: 0 !important;
    border-bottom-right-radius: 0 !important;
    font-family: var(--font-rc-full), ui-sans-serif, system-ui, sans-serif !important;
  }
  .marksmith .marksmith-help-link,
  .marksmith .marksmith-upload-button,
  .marksmith .marksmith-gallery-link {
    color: #fff !important;
  }
  .marksmith .marksmith-help-link svg {
    width: 1.1rem;
    height: 1.1rem;
    display: inline-block;
    vertical-align: middle;
    margin-right: 0.375rem;
    flex-shrink: 0;
    fill: currentColor;
  }

  /* Two-tab styling (Write / Preview) */
  .marksmith .bp-ms-tabs {
    height: 100% !important;
  }
  .marksmith .bp-ms-tab {
    color: #fff !important;
    background: transparent;
    border: none !important;
    height: 100% !important;
    display: inline-flex !important;
    align-items: center !important;
    padding: 0 1rem; /* increased horizontal padding */
    font-family: var(--font-rc-full), ui-sans-serif, system-ui, sans-serif !important;
  }
  .marksmith .bp-ms-tab.active {
    background: #fff !important; /* white bg when active */
    color: var(--color-bp-dark) !important; /* bp-dark text when active */
  }

  /* Toolbar button hover and sizing */
  .marksmith .marksmith-action-bar > * {
    height: 100% !important;
    display: inline-flex !important;
    align-items: center !important;
    padding: 0 0.75rem !important;
    border-radius: 0 !important; /* square corners */
    background: transparent; /* allow per-button classes to override */
    color: #fff; /* allow per-button classes to override */
  }
  .marksmith .marksmith-action-bar > *:hover {
    background: var(--color-bp-light); /* full-area hover */
    color: var(--color-bp-dark);
  }
}
