<%= form_with model: @project, html: { class: "space-y-6", data: { controller: "project-validator", project_validator_project_id_value: @project.id } } do |f| %>
  <% if @project.errors.any? %>
    <div class="p-4 text-red-900 rounded-md bg-bp-danger">
      <p><strong><%= pluralize(@project.errors.count, "error") %></strong> prevented this project from being saved:</p>
      <ul class="pl-5 list-disc">
        <% @project.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div>
    <%= f.label :title, class: "block text-xl font-medium" %>
    <%= f.text_field :title,
          required: true,
          class: "input px-3 w-full",
          data: { project_validator_target: "title", action: "input->project-validator#validate change->project-validator#validate" } %>
  </div>

  <div>
    <%= f.label :description, class: "block text-xl font-medium" %>
    <%= f.text_area :description,
          required: true,
          rows: 6,
          class: "input px-3 mt-1 block w-full",
          data: { project_validator_target: "description", action: "input->project-validator#validate change->project-validator#validate" } %>
  </div>

  <div>
    <div class="flex items-center">
      <div>
        <%= f.label :repo_link, class: "block text-xl font-medium" %>
        <p class="text-sm">We'll create a JOURNAL.md for you</p>
      </div>
      <div class="grow"></div>
      <%= render "shared/button", text: "Configure GitHub", class: "py-1 px-2 text-base", url: github_login_path, html_options: { target: "_blank" } %>
    </div>
    <%= f.text_field :repo_link,
          placeholder: "https://github.com/...",
          class: "input px-3 mt-1 block w-full",
          data: {
            project_validator_target: "repo",
            action: "input->project-validator#queueRepoCheck change->project-validator#queueRepoCheck"
          } %>
    <div class="flex justify-end mt-1 space-x-2 text-sm text-right">
      <p data-project-validator-target="status">You must have write access to the repository.</p>
    </div>
  </div>

  <div>
    <%= f.label :banner, class: "block text-xl font-medium" %>
    <div class="flex items-center gap-3 mt-1" data-controller="file-input">
      <%= f.file_field :banner, direct_upload: true, id: "project_banner_input", class: "hidden", data: { file_input_target: "input" }, "data-action": "change->file-input#update" %>
      <label for="project_banner_input" class="btn btn-outline">Choose file</label>
      <span data-file-input-target="filename" data-placeholder="No file selected">No file selected</span>
    </div>
  </div>

  <div>
    <div>
      <%= f.label :needs_funding, "Do you need a grant to build your project?", class: "block text-xl font-medium" %>
      <p class="text-sm">You can get extra tickets if you don't need funding.</p>
    </div>
    <div class="flex gap-4 mt-2">
      <%= f.label :needs_funding_true, class: "flex items-center gap-2 cursor-pointer" do %>
        <%= f.radio_button :needs_funding, true, class: "hidden peer" %>
        <div class="border-2 size-4 peer-checked:bg-white"></div>
        <span>I need funding</span>
      <% end %>
      <%= f.label :needs_funding_false, class: "flex items-center gap-2 cursor-pointer" do %>
        <%= f.radio_button :needs_funding, false, class: "hidden peer" %>
        <div class="border-2 size-4 peer-checked:bg-white"></div>
        <span>I don't need funding or am already building</span>
      <% end %>
    </div>
  </div>

  <div>
    <%= f.submit (@project.new_record? ? "Create project" : "Update project"), class: "btn btn-primary block w-full", data: { project_validator_target: "submit" } %>
  </div>
<% end %>
