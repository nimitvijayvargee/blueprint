<% reviews = event[:reviews] || [] %>
<% admin_review = reviews.find { |r| r[:admin_review] } %>
<% has_content = reviews.any? { |r| r[:feedback].present? } || project.approved_tier.present? || project.approved_funding_cents.present? %>

<% if has_content %>
  <%= render "timeline_event_card" do %>
    <div class="flex space-x-4">
      <p class="grow">
        <%= reviews.map { |r| render("shared/user_inline", user: r[:user]) }.join(" and ").html_safe %>
        approved <%= project.title %> <%= time_ago_in_words(event[:date]) %> ago
      </p>
    </div>
    <div class="timeline-journal">
      <% if project.approved_tier.present? %>
        <p><strong>Tier approved:</strong> <%= project.approved_tier %></p>
      <% end %>
      <% if project.approved_funding_cents.present? %>
        <p><strong>Grant approved:</strong> $<%= sprintf("%.2f", project.approved_funding_cents / 100.0) %></p>
      <% end %>
      <% reviews.each do |review| %>
        <% if review[:feedback].present? %>
          <div class="mt-2">
            <p><%= review[:feedback] %></p>
          </div>
        <% end %>
      <% end %>
    </div>
  <% end %>
<% else %>
  <%= render "timeline_event_basic", icon: "icons/approve.svg" do %>
    <p>
      <%= reviews.map { |r| render("shared/user_inline", user: r[:user]) }.join(" and ").html_safe %>
      approved <%= project.title %> <span title="<%= event[:date] %>"><%= time_ago_in_words(event[:date]) %> ago</span>
    </p>
  <% end %>
<% end %>
