<!DOCTYPE html>
<html>
  <head>
    <title>Blueprint</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body class="grid-bg grainy-bg">
    <svg width="0" height="0" class="block">
      <filter id="grainy" x="0" y="0" width="100%" height="100%">
        <feTurbulence type="fractalNoise" baseFrequency=".3" numOctaves="2"/>
        <feColorMatrix type="saturate" values="0"/>
        <feBlend in="SourceGraphic" mode="multiply"/>
      </filter>
    </svg>
    <%= render "shared/notice" %>
    <main data-controller="landing">
      <div class="fixed top-8 left-0 z-[100]">
        <a href="https://hackclub.com?utm_source=blueprint" target="_blank">
          <%= inline_svg 'hackclub-logo.svg', class: 'h-16' %>
        </a>
      </div>
      <div class="fixed top-8 right-8 z-[100]">
        <% if current_user.present? %>
          <%= render "shared/button", url: home_path, text: "Go home", variant: :outline, class: "bg-bp-dark border-2 px-4 py-2 text-xl" %>
        <% else %>
          <%= render "shared/button", url: login_path, text: "Log in!", variant: :outline, class: "bg-bp-dark border-2 px-4 py-2 text-xl" %>
        <% end %>
      </div>

      <!-- Hero bg -->
      <div class="absolute top-0 left-0 right-0 bg-bottom bg-no-repeat bg-cover pointer-events-none select-none bg-bp-dark" data-landing-target="overlay"
           style="mask-image: linear-gradient(170deg, rgba(0,0,0,1) 100%, rgba(0,0,0,0) 100%);">
        <img src="<%= image_path('hero.png') %>" aria-hidden="true" class="top-0 left-0 right-0 min-h-screen opacity-0">
      </div>
      <div class="absolute top-0 left-0 right-0 bg-bottom bg-no-repeat bg-cover pointer-events-none select-none" data-landing-target="hero"
           style="background-image: url('<%= image_path('hero.png') %>'); mask-image: linear-gradient(170deg, rgba(0,0,0,0.5) 100%, rgba(0,0,0,0) 100%);">
        <img src="<%= image_path('hero.png') %>" aria-hidden="true" class="top-0 left-0 right-0 min-h-screen opacity-0">
      </div>

      <div class="absolute top-0 left-0 right-0 bg-bottom bg-no-repeat bg-cover pointer-events-none select-none -z-10" data-landing-target="heroOutline"
           style="background-image: url('<%= image_path('hero-outline.jpg') %>'); mask-image: linear-gradient(170deg, rgba(0,0,0,0) 100%, rgba(0,0,0,1) 100%);">
        <img src="<%= image_path('hero.png') %>" aria-hidden="true" class="top-0 left-0 right-0 min-h-screen opacity-0">
      </div>

      <div class="relative w-full">
        <img src="<%= image_path('hero.png') %>" aria-hidden="true" class="top-0 left-0 right-0 min-h-screen opacity-0">
        
        <!-- Hero title -->
        <div class="absolute top-0 left-0 right-0 flex flex-col items-center justify-center min-h-screen space-y-32" data-landing-target="heroContent">
          <div class="space-y-2">
            <div class="relative flex flex-col items-center">
              <h1 class="text-[10rem]/40 font-rcgl-full">Blueprint</h1>
              <p class="p-1 ml-auto -mr-8 text-4xl rotate-5 bg-bp-dark -mt-7">...then build</p>
            </div>
            <div class="flex flex-col -ml-12">
              <h2 class="text-3xl text-center mr-52">Design a hardware project,</h2>
              <p class="text-xl text-right"> and we'll pay for hardware to build it!<sup>*</sup></p>
            </div>
          </div>
          <div class="flex flex-col items-center px-12 py-8 space-y-2 text-2xl border-2 bg-bp-dark">
            <p class="text-3xl uppercase">Get free stickers</p>
            <div class="flex" data-controller="email-redirect" data-email-redirect-login-url-value="<%= login_path %>">
              <input type="email" data-email-redirect-target="input" class="text-left py-1.5 px-4 appearance-none outline-0 border-2 border-r-0" placeholder="orpheus@hackclub.com" data-action="keydown->email-redirect#checkEnter" />
              <button type="button" data-action="click->email-redirect#go" class="w-full px-6 bg-white border-2 border-l-0 border-white text-bp-dark hover:bg-gray-200 hover:border-gray-200">Join</button>
            </div>
          </div>
        </div>
      </div>

      <div class="pb-12 space-y-18">
        <p class="text-5xl text-center">How does this work?</p>
        <div class="flex justify-center px-8 text-center">
          <div class="grid max-w-6xl grid-cols-4 gap-12">
            <div class="flex flex-col p-8 space-y-4 border-2 bg-bp-dark">
              <p class="text-2xl font-bold">Design</p>
              <p class="flex items-center justify-center grow">Create your hardware designs in CAD</p>
            </div>
            <div class="flex flex-col p-8 space-y-4 border-2 bg-bp-dark">
              <p class="text-2xl font-bold">Submit</p>
              <p class="flex items-center justify-center grow">We'll review your design and get back to you</p>
            </div>
            <div class="flex flex-col p-8 space-y-4 border-2 bg-bp-dark">
              <p class="text-2xl font-bold">Build</p>
              <p class="flex items-center justify-center grow">Get funding to make your project real</p>
            </div>
            <div class="flex flex-col p-8 space-y-4 border-2 bg-bp-dark">
              <p class="text-2xl font-bold">Share</p>
              <p class="flex items-center justify-center grow">Ship your creation to get tools for your next project</p>
            </div>
          </div>
        </div>
      </div>

      <% featured_projects = [
        {
          title: "Serenity",
          url: "https://github.com/The-UnknownHacker/Serenity",
          image: "https://hc-cdn.hel1.your-objectstorage.com/s/v3/83cea4e7008db1f618e6f33b12a19d25924259c9_image.png",
          description: "Touch-based drumpad with ESP32-S3, copper PCB sensing, microSD storage, and configurable sound layers",
          author: "The-UnknownHacker"
        },
        {
          title: "CyberTrust",
          url: "https://github.com/Aahil78/CyberTrust",
          image: "https://hc-cdn.hel1.your-objectstorage.com/s/v3/625db8d60acaa7cdf3406308dedd19f21e35954f_image.png",
          description: "RP2350A-based USB security key with user presence button and neopixel",
          author: "Aahil78",
        },
        {
          title: "Nexo-BT",
          url: "https://github.com/Arrow-07/NexoBT",
          image: "https://hc-cdn.hel1.your-objectstorage.com/s/v3/aaaa4a0cdd5f4ae02713865f04ad86aa1edd7bcb_image.png",
          description: "Wireless music receiver with balanced XLR outputs using ESP32 and PCM5102APWR DAC",
          author: "Arrow-07",
        },
        {
          title: "KeyDeck",
          url: "https://github.com/CJBrandi/KeyDeck/",
          image: "https://hc-cdn.hel1.your-objectstorage.com/s/v3/98560ad52d04e91c453043c0c68692ae78a5f209_image.png",
          description: "Simple macropad with 2 status LEDs, each button runs a different shortcut",
          author: "CJBrandi",
        },
        {
          title: "bop",
          url: "https://github.com/ShuchirJ/bop",
          image: "https://raw.githubusercontent.com/ShuchirJ/bop/main/render.png",
          description: "Bluetooth audio receiver with line level and headphone level outputs",
          author: "ShuchirJ"
        },
        {
          title: "Fulmen",
          url: "https://github.com/AethelVeritas/Fulmen/tree/main",
          image: "https://hc-cdn.hel1.your-objectstorage.com/s/v3/826c1fc2c73606fe19d470a00726393d26af5777_image.png",
          description: "Small ergonomic low-profile wireless keyboard, reversible design",
          author: "AethelVeritas"
        },
        {
          title: "Bicolor Matrix Board",
          url: "https://github.com/picafe/bicolor-matrix",
          image: "https://raw.githubusercontent.com/picafe/bicolor-matrix/main/assets/kicad_k9HAfz9kqA.png",
          description: "Red and green 32x8 LED matrix with HT16K33A IC",
          author: "picafe"
        },
        {
          title: "Quaero",
          url: "https://github.com/AethelVeritas/Quaero/tree/main",
          image: "https://raw.githubusercontent.com/AethelVeritas/Quaero/refs/heads/main/pics/pic_16.png",
          description: "Low-profile split ergo keyboard with splay, removable column/number row, and trackpad support",
          author: "AethelVeritas"
        },
        {
          title: "WASP",
          url: "https://github.com/justhar/WASP-OPSI",
          image: "https://raw.githubusercontent.com/justhar/WASP-OPSI/main/WASP.png",
          description: "Wi-Fi sensing platform with 8 synchronized ESP32 nodes for AoA, localization, and gesture recognition",
          author: "justhar"
        },
        {
          title: "Athena",
          url: "https://github.com/NotARoomba/Athena",
          image: "https://raw.githubusercontent.com/NotARoomba/Athena/main/assets/board_front.png",
          description: "Advanced flight controller with triple MCU architecture",
          author: "NotARoomba"
        },
        {
          title: "wake",
          url: "https://github.com/JavaScythe/wake/",
          image: "https://hc-cdn.hel1.your-objectstorage.com/s/v3/9fa7d0bf0d3d7f7041138a8fbcee0b6e9a18b987_image.png",
          description: "Advanced alarm clock with 35 neopixels, ESP32 wifi, speaker, buzzer, and projector",
          author: "JavaScythe"
        },
        {
          title: "Automatic Toilet Paper Folder V2",
          url: "https://github.com/Synaptic-Odyssey/AutomaticToiletPaperFolder_V2",
          image: "https://raw.githubusercontent.com/Synaptic-Odyssey/AutomaticToiletPaperFolder_V2/refs/heads/main/Images/ATPF_poster.png",
          description: "Streamlined product version of the 1st place Highway to Undercity project",
          author: "Synaptic-Odyssey"
        },
        {
          title: "PR Mini Bot",
          url: "https://github.com/tobycm/pr-mini-bot",
          image: "https://raw.githubusercontent.com/tobycm/pr-mini-bot/refs/heads/main/images/3d.png",
          description: "Miniature bot mimicking 8339 2025 FRC bot with solar panel and supercaps for power harvesting",
          author: "tobycm"
        },
        {
          title: "VikramSatv0 Electrical Power Sub-system",
          url: "https://github.com/Rishaan2202/VikramSat_Electrical-Power-Sub-System",
          image: "https://hc-cdn.hel1.your-objectstorage.com/s/v3/8a126694bd272e8df76d3cdfee6883ce0abde398_image.png",
          description: "Fully functional EPS for 2U CubeSat project by 14-year-old maker",
          author: "Rishaan2202"
        }
      ] %>

      <div class="space-y-12">
        <p class="text-3xl text-center">Here's what others are working on</p>
        <div class="overflow-hidden">
          <div class="flex space-x-8 space-y-8 carousel h-84">
            <% featured_projects.shuffle.each do |project| %>
              <a href="<%= project[:url] %>" target="_blank" rel="noopener noreferrer" class="flex flex-col h-full w-72 shrink-0 bg-bp-darker" data-carousel-target="item">
                <div class="h-40 bg-gray-200 bg-center bg-no-repeat bg-cover" style="background-image: url(<%= project[:image] %>)"></div>
                <div class="flex flex-col p-4 space-y-2 grow">
                  <p class="text-xl font-bold"><%= project[:title] %> <span class="text-xs">by <%= project[:author] %></span></p>
                  <p><%= project[:description] %></p>
                </div>
              </a>
            <% end %>
          </div>
        </div>
      </div>
    
      <!-- Divider Image -->
      <div class="w-full py-16">
        <%= image_tag "divider2.png", class: "w-full h-auto" %>
      </div>
    
    <div class="flex flex-col items-center w-full px-8">
      
      <!-- What is Hack Club Section -->
      <section class="w-full max-w-6xl py-24">
        <div class="flex flex-col items-center px-8">
          <h2 class="mb-8 text-4xl font-bold text-center">What is Hack Club?</h2>
          <div class="flex flex-col max-w-4xl px-16 py-10 border-2 bg-hatch border-white/25">
            <p class="text-xl leading-relaxed text-center">
              Hack Club is a global network of high school hackers and makers. We're a nonprofit that supports students who want to build cool things with code and hardware. Blueprint is one of our programs where we fund your hardware projects and help you learn by building.
            </p>
          </div>
        </div>
      </section>
      
      <!-- FAQ Section -->
      <section class="w-full max-w-6xl py-24">
        <div class="flex flex-col items-center px-8">
          <h2 class="text-4xl font-bold text-center">FAQ</h2>
          <div class="h-6"></div>
          <div class="grid w-full grid-cols-3 gap-8">
            <div class="flex flex-col px-8 py-6 border-2 bg-hatch border-white/25">
              <h3 class="mb-3 text-xl font-bold">When does this program end?</h3>
              <p class="text-base">Currently, the end-date of Blueprint is December 1st</p>
            </div>
            
            <div class="flex flex-col px-8 py-6 border-2 bg-hatch border-white/25">
              <h3 class="mb-3 text-xl font-bold">How many projects can I make?</h3>
              <p class="text-base">As many as you like! We just ask that you only do one of each starter project</p>
            </div>
            
            <div class="flex flex-col px-8 py-6 border-2 bg-hatch border-white/25">
              <h3 class="mb-3 text-xl font-bold">Who can apply?</h3>
              <p class="text-base">Any student currently enrolled in high school!</p>
            </div>
            
            <div class="flex flex-col px-8 py-6 border-2 bg-hatch border-white/25">
              <h3 class="mb-3 text-xl font-bold">Can I double dip with Summer of Making or any other Hack Club program?</h3>
              <p class="text-base">No! Double-dipping is not allowed. If you have coding time for your project, you can journal it, get tickets, and get prizes from the tool bag.</p>
            </div>
            
            <div class="flex flex-col px-8 py-6 border-2 bg-hatch border-white/25">
              <h3 class="mb-3 text-xl font-bold">Do I need prior experience?</h3>
              <p class="text-base">Not at all! We welcome beginners and provide resources to help you learn and build your project successfully.</p>
            </div>
            
            <div class="flex flex-col px-8 py-6 border-2 bg-hatch border-white/25">
              <h3 class="mb-3 text-xl font-bold">If I need more money, can I pay myself?</h3>
              <p class="text-base">Yes!</p>
            </div>
          </div>
          <div class="pt-16 text-center">
            <div class="h-6"></div>
            <a href="/faq" class="text-lg underline text-bp-warning hover:text-white">
              View Full FAQ â†’
            </a>
          </div>
        </div>
      </section>
      
      <!-- Get Started Section -->
      <section class="w-full max-w-6xl py-24">
        <div class="flex flex-col items-center space-y-2 text-2xl">
          <p class="text-3xl uppercase">Get Started</p>
          <div class="flex" data-controller="email-redirect" data-email-redirect-login-url-value="<%= login_path %>">
            <input type="email" data-email-redirect-target="input" class="text-left py-1.5 px-4 appearance-none outline-0 border-2 border-r-0" placeholder="orpheus@hackclub.com">
            <button type="button" data-action="click->email-redirect#go" class="w-full px-6 bg-white border-2 border-l-0 border-white text-bp-dark hover:bg-gray-200 hover:border-gray-200">Join</button>
          </div>
        </div>
      </section>
    </div>

    <!-- Carousel JavaScript -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const carousel = document.getElementById('project-carousel');
        if (!carousel) return;
        
        // Individual card wrapping variables
        let scrollSpeed = 0.5; // Pixels per frame
        let isAutoScrolling = true;
        
        const cardWidth = 320; // 320px (w-80 + margin)
        const cards = Array.from(carousel.children);
        
        // Set up carousel container and individual card positioning
        carousel.style.position = 'relative';
        carousel.style.height = '400px'; // Match h-[400px]
        
        cards.forEach((card, index) => {
          card.style.position = 'absolute';
          card.style.left = `${index * cardWidth}px`;
          card.style.top = '0';
        });
        
        // Individual card animation function
        function animateCards() {
          if (isAutoScrolling) {
            const containerWidth = carousel.parentElement.offsetWidth;
            
            cards.forEach((card) => {
              const currentLeft = parseFloat(card.style.left) || 0;
              const newLeft = currentLeft - scrollSpeed;
              
              // If card moved completely off left edge, wrap to just off the right edge
              if (newLeft <= -cardWidth) {
                // Calculate the rightmost card position to maintain tight spacing
                const allPositions = cards.map(c => parseFloat(c.style.left) || 0);
                const rightmostPosition = Math.max(...allPositions);
                
                // Position new card immediately after the rightmost card
                card.style.left = `${rightmostPosition + cardWidth}px`;
              } else {
                card.style.left = `${newLeft}px`;
              }
            });
          }
          
          requestAnimationFrame(animateCards);
        }
        
        // Hover controls
        carousel.addEventListener('mouseenter', () => {
          isAutoScrolling = false;
        });
        
        carousel.addEventListener('mouseleave', () => {
          isAutoScrolling = true;
        });
        
        // Touch pause
        carousel.addEventListener('touchstart', () => {
          isAutoScrolling = false;
          setTimeout(() => isAutoScrolling = true, 3000);
        });
        
        // Initialize
        animateCards();
      });
    </script>
  </body>
</html>
